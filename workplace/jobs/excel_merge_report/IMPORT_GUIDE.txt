================================================================================
                    คู่มือการ Import ไฟล์เข้าระบบ
================================================================================

ภาพรวม
--------
ระบบนี้รองรับการ import ข้อมูลจาก 3 ประเภท:
  1. Income Files (ไฟล์รายรับ) - รูปแบบ CSV
  2. Expense Files (ไฟล์รายจ่าย) - รูปแบบ Excel (.xlsx, .xls)
  3. Master Data (ข้อมูลหลัก) - รูปแบบ Excel (.xlsx, .xls)


================================================================================
การเตรียมไฟล์
================================================================================

1. Income Files (ไฟล์รายรับ)
----------------------------
  - รูปแบบไฟล์: .csv เท่านั้น
  - โครงสร้างไฟล์: ต้องมี header row และข้อมูล
  - ฟิลด์สำคัญ: 
      * วันที่ (Date)
      * ประเภทรายการ (Type)
      * จำนวนเงิน (Amount)
      * รหัสการจอง (Confirmation Code)
      * ข้อมูลทรัพย์สิน (Listing)
      * ข้อมูลเจ้าของ (Owner Name, Owner Email)


2. Expense Files (ไฟล์รายจ่าย)
------------------------------
  - รูปแบบไฟล์: .xlsx หรือ .xls
  - โครงสร้างไฟล์: ต้องมี header row และข้อมูล
  - ฟิลด์สำคัญ:
      * วันที่ (Date)
      * ชื่อทรัพย์สิน (Listing Name)
      * หมวดหมู่ (Category)
      * รายละเอียด (Description)
      * จำนวนเงิน (Amount)
      * ข้อมูลเจ้าของ (Owner Name, Owner Email)


3. Master Data (ข้อมูลหลัก)
----------------------------
  - รูปแบบไฟล์: .xlsx หรือ .xls
  - โครงสร้างไฟล์: ต้องมี header row และข้อมูล
  - ใช้สำหรับ: ข้อมูลอ้างอิงหรือข้อมูลหลักของระบบ


================================================================================
ขั้นตอนการ Import ไฟล์
================================================================================

วิธีที่ 1: ใช้ Google Drive Folders
-----------------------------------

ขั้นตอนที่ 1: อัปโหลดไฟล์ไปยัง Folder ที่กำหนด
  - Income Files → Income Folder
    https://drive.google.com/drive/folders/1nRrPE-4Dx8qgbPRRMXLQxEJoDXmR8QFS
    
  - Expense Files → Expense Folder
    https://drive.google.com/drive/folders/1HXqLLr5l4XudL-Hozu4LLiln15BFkiiv
    
  - Master Data → Master Data Folder
    https://drive.google.com/drive/folders/1hDSvH4_ycEAbrc2Djh6qt1t84NWntMsy

ขั้นตอนที่ 2: เปิด Google Sheets ที่เชื่อมต่อกับระบบ

ขั้นตอนที่ 3: เลือกเมนู "Data Importer" จากแถบเมนูด้านบน

ขั้นตอนที่ 4: เลือกประเภทการ Import
  - Import All Data - Import ทุกประเภทพร้อมกัน
  - Import Income Files - Import เฉพาะไฟล์รายรับ
  - Import Expense Files - Import เฉพาะไฟล์รายจ่าย
  - Import Master Data Files - Import เฉพาะข้อมูลหลัก

ขั้นตอนที่ 5: รอให้กระบวนการเสร็จสิ้น
  ระบบจะแสดงข้อความแจ้งเตือนระหว่างการประมวลผล


================================================================================
กระบวนการทำงานของระบบ
================================================================================

สำหรับ Income Files:
---------------------
  1. อ่านไฟล์ CSV จาก Income Folder
  2. ตรวจสอบว่าไฟล์มีข้อมูลหรือไม่
  3. ประมวลผลข้อมูล:
     - แปลงวันที่ให้อยู่ในรูปแบบที่ถูกต้อง
     - จัดเรียงข้อมูลตามวันที่
     - สร้างฟิลด์เพิ่มเติม (Bank Account Logic)
  4. นำเข้าข้อมูลไปยัง Sheet "Income Files"
  5. ย้ายไฟล์ที่ประมวลผลแล้วไปยัง Archive Folder


สำหรับ Expense Files:
----------------------
  1. อ่านไฟล์ Excel จาก Expense Folder
  2. แปลงไฟล์ Excel เป็น Google Sheets ชั่วคราว
  3. อ่านข้อมูลจาก Sheet แรก
  4. นำเข้าข้อมูลไปยัง Sheet "Expense Files"
  5. ย้ายไฟล์ไปยัง Archive Folder และลบ Google Sheets ชั่วคราว


สำหรับ Master Data:
--------------------
  1. อ่านไฟล์ Excel จาก Master Data Folder
  2. แปลงและประมวลผลข้อมูล
  3. นำเข้าข้อมูลไปยัง Sheet "Master Data"
  4. ย้ายไฟล์ไปยัง Archive Folder


================================================================================
ตำแหน่งข้อมูลหลังการ Import
================================================================================

ข้อมูลที่ import จะถูกเพิ่มไปยัง Sheet ต่อไปนี้:
  - Income Files Sheet → ข้อมูลรายรับทั้งหมด
  - Expense Files Sheet → ข้อมูลรายจ่ายทั้งหมด
  - Master Data Sheet → ข้อมูลหลักทั้งหมด

หมายเหตุ: ข้อมูลใหม่จะถูกเพิ่มต่อท้ายข้อมูลเดิม (ไม่มีการลบหรือเขียนทับ)


================================================================================
การตรวจสอบผลการ Import
================================================================================

ใน Google Sheets:
------------------
  1. เปิด Sheet ที่เกี่ยวข้อง
  2. ตรวจสอบแถวข้อมูลล่าสุด
  3. ยืนยันว่าข้อมูลถูกต้องและครบถ้วน


================================================================================
ข้อควรระวังและปัญหาที่พบบ่อย
================================================================================

1. ไฟล์ไม่ถูก Import
--------------------
  สาเหตุ:
    - ไฟล์อยู่ในรูปแบบที่ไม่ถูกต้อง 
      (Income ต้องเป็น .csv, Expense/Master Data ต้องเป็น .xlsx/.xls)
    - ไฟล์ว่างเปล่า (ไม่มีข้อมูล)
    - ไฟล์อยู่ใน Folder ที่ไม่ถูกต้อง

  วิธีแก้:
    - ตรวจสอบรูปแบบไฟล์
    - ตรวจสอบว่าไฟล์มีข้อมูล (อย่างน้อย 1 แถว + header)
    - ยืนยันว่าอัปโหลดไปยัง Folder ที่ถูกต้อง


2. ข้อมูลไม่ครบถ้วน
-------------------
  สาเหตุ:
    - Header row ไม่ตรงกับที่ระบบคาดหวัง
    - มีคอลัมน์ที่ขาดหายไป

  วิธีแก้:
    - ตรวจสอบโครงสร้างไฟล์ให้ตรงกับฟอร์แมตที่กำหนด
    - ตรวจสอบชื่อคอลัมน์ใน header row


3. ไฟล์ไม่ถูกย้ายไป Archive
---------------------------
  สาเหตุ:
    - ไม่มีสิทธิ์เข้าถึง Archive Folder
    - เกิดข้อผิดพลาดระหว่างการประมวลผล

  วิธีแก้:
    - ตรวจสอบสิทธิ์การเข้าถึง Folder
    - ดู Log ใน Apps Script เพื่อหาข้อผิดพลาด


4. วันที่แสดงผลไม่ถูกต้อง
--------------------------
  สาเหตุ:
    - รูปแบบวันที่ในไฟล์ไม่ตรงกับที่ระบบรองรับ

  วิธีแก้:
    - ใช้รูปแบบวันที่มาตรฐาน: MM/DD/YYYY หรือ YYYY-MM-DD


================================================================================
การเข้าสู่ระบบ
================================================================================

ขั้นตอน:
  1. เปิด Web App URL
  2. กรอกอีเมลและรหัสผ่าน
  3. คลิก "Sign In"
  4. ระบบจะแสดงข้อมูลที่เกี่ยวข้องกับอีเมลนั้น


================================================================================
การติดต่อและการสนับสนุน
================================================================================

หากพบปัญหาหรือต้องการความช่วยเหลือ:
  1. ตรวจสอบ Log ใน Apps Script Executions
  2. ตรวจสอบข้อมูลใน Archive Folders
  3. ติดต่อทีมพัฒนาระบบ


================================================================================
หมายเหตุเพิ่มเติม
================================================================================

  * ระบบจะเก็บ session การเข้าสู่ระบบไว้ 6 ชั่วโมง
  
  * ไฟล์ที่ import แล้วจะถูกย้ายไปยัง Archive Folder อัตโนมัติ
  
  * สามารถ import ไฟล์หลายไฟล์พร้อมกันได้
  
  * ระบบจะข้ามไฟล์ที่ไม่ตรงรูปแบบโดยอัตโนมัติ
  
  * ข้อมูลจะถูกเพิ่มต่อท้าย ไม่มีการลบข้อมูลเดิม


================================================================================

เวอร์ชัน: 1.0
อัปเดตล่าสุด: ธันวาคม 2025

================================================================================
