<!DOCTYPE html>
<html lang="en">

<head>
    <!-- no cache -->
    <base target="_top">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <!-- no cache -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>maison KEEPS - Luxury Design Form</title>
    <meta name="description" content="maison KEEPS - Luxury Design Form">
    <meta name="keywords" content="maison KEEPS, Luxury Design, Fashion Design, Haute Couture, Premium Fashion">
    <meta name="author" content="maison KEEPS">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@100;200;300;400;500;600;700&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/nprogress@0.2.0/nprogress.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />
    <style>
        * {
            font-family: 'Source Code Pro', 'IBM Plex Sans Thai', monospace, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Thai language specific font */
        :lang(th),
        .thai-text {
            font-family: 'IBM Plex Sans Thai', sans-serif;
        }

        /* English language specific font */
        :lang(en),
        .english-text {
            font-family: 'Source Code Pro', monospace;
        }

        body {
            background-color: #fcfbfb;
            color: #2c2c2c;
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            position: relative;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
        }

        .form-container {
            background-color: #e9e9e9;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
            padding: 40px;
            margin-top: 30px;
            margin-bottom: 40px;
            border: 1px solid #e0e0e0;
            position: relative;
            overflow: hidden;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #2c2c2c, #1a1a1a, #333333, #2c2c2c);
        }

        .form-title {
            color: #2c2c2c;
            font-family: 'Source Code Pro', monospace;
            font-weight: 600;
            margin-bottom: 25px;
            text-align: center;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .form-subtitle {
            color: #4a4a4a;
            font-family: 'Source Code Pro', monospace;
            font-weight: 500;
            margin-bottom: 25px;
            letter-spacing: 1px;
            position: relative;
            padding-bottom: 15px;
        }

        .form-subtitle::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 2px;
            background-color: #2c2c2c;
        }

        .steps-container {
            margin-bottom: 40px;
            position: relative;
        }

        .steps-container::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 25%;
            width: 50%;
            height: 1px;
            background-color: #333;
            z-index: 0;
        }

        .step {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e8e8e8;
            color: #666666;
            font-weight: 400;
            margin: 0 auto 10px auto;
            transition: all 0.5s ease;
            position: relative;
            z-index: 1;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #d0d0d0;
        }

        .step-title {
            font-size: 14px;
            color: #666666;
            text-align: center;
            transition: all 0.5s ease;
        }

        .step.active {
            background: linear-gradient(145deg, #2c2c2c, #1a1a1a);
            color: #fff;
            box-shadow: 0 0 15px rgba(44, 44, 44, 0.5);
            transform: scale(1.05);
        }

        .step-title.active {
            color: #2c2c2c;
            font-weight: 400;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-step.active {
            display: block;
        }

        .form-label {
            font-weight: 500;
            color: #2c2c2c;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: inline-block;
            position: relative;
            padding-left: 12px;
            text-transform: uppercase;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            text-shadow: none;
            transform: perspective(100px) translateZ(0px);
        }

        .form-label::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 100%;
            width: 3px;
            background: linear-gradient(to bottom, #2c2c2c, #1a1a1a);
            border-radius: 2px;
        }

        .form-label.required-field {
            color: #1a1a1a;
        }

        .form-control,
        .form-select {
            padding: 12px 15px;
            border-radius: 6px;
            border: 1px solid #d0d0d0;
            background-color: #ffffff;
            color: #2c2c2c;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-top: 5px;
            font-weight: 300;
        }

        .form-control::placeholder {
            color: #888888;
            opacity: 0.8;
        }

        .form-control:focus,
        .form-select:focus {
            border-color: #2c2c2c;
            box-shadow: 0 0 0 0.25rem rgba(44, 44, 44, 0.25), 0 1px 3px rgba(0, 0, 0, 0.1);
            background-color: #ffffff;
            outline: none;
            transform: translateY(-2px);
        }

        /* Select2 Dark Theme Styling */
        .select2-container--bootstrap-5 .select2-selection--single {
            border: 1px solid #d0d0d0;
            background-color: #ffffff;
            height: calc(2.25rem + 2px);
        }

        /* Override all Select2 focus states with dark theme styling */
        .select2-container--bootstrap-5 .select2-selection--single:focus,
        .select2-container--bootstrap-5.select2-container--focus .select2-selection--single,
        .select2-container--bootstrap-5.select2-container--open .select2-selection--single,
        .select2-container--bootstrap-5 .select2-selection--single:active {
            border-color: #2c2c2c !important;
            box-shadow: 0 0 0 0.2rem rgba(44, 44, 44, 0.15),
                0 2px 8px rgba(44, 44, 44, 0.12),
                0 4px 15px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.9) !important;
            outline: none !important;
            transform: translateY(-1px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Additional override for any remaining blue shadows */
        .select2-container--bootstrap-5 .select2-selection {
            border-color: #d0d0d0 !important;
        }

        .select2-container--bootstrap-5 .select2-selection:focus-within,
        .select2-container--bootstrap-5 .select2-selection:focus {
            border-color: #2c2c2c !important;
            box-shadow: 0 0 0 0.2rem rgba(44, 44, 44, 0.15),
                0 2px 8px rgba(44, 44, 44, 0.12),
                0 4px 15px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.9) !important;
            outline: none !important;
        }

        .select2-container--bootstrap-5 .select2-selection--single .select2-selection__rendered {
            color: #2c2c2c;
            padding-left: 15px;
            padding-right: 15px;
        }

        .select2-container--bootstrap-5 .select2-selection--single .select2-selection__placeholder {
            color: #888888;
        }

        .select2-dropdown {
            border: 1px solid #2c2c2c;
            box-shadow: 0 4px 15px rgba(44, 44, 44, 0.15);
        }

        /* Override Select2 search input focus styling */
        .select2-search--dropdown .select2-search__field {
            border: 1px solid #d0d0d0 !important;
            background-color: #ffffff !important;
            color: #2c2c2c !important;
        }

        .select2-search--dropdown .select2-search__field:focus {
            border-color: #2c2c2c !important;
            box-shadow: 0 0 0 0.2rem rgba(44, 44, 44, 0.15),
                0 2px 8px rgba(44, 44, 44, 0.12),
                0 4px 15px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.9) !important;
            outline: none !important;
        }

        /* Additional override for inline search in Select2 */
        .select2-container .select2-search--inline .select2-search__field {
            border: none !important;
            background-color: transparent !important;
            box-shadow: none !important;
            outline: none !important;
        }

        .select2-container .select2-search--inline .select2-search__field:focus {
            border: none !important;
            box-shadow: none !important;
            outline: none !important;
        }

        .select2-results__option {
            color: #2c2c2c;
            background-color: #ffffff;
        }

        .select2-results__option--highlighted {
            background-color: #2c2c2c;
            color: #ffffff;
        }

        .select2-results__option--selected {
            background-color: #f5f5f5;
            color: #2c2c2c;
        }

        .form-check-label {
            color: #2c2c2c;
            transition: all 0.3s ease;
        }

        .form-check-label:hover {
            color: #1a1a1a;
        }

        .form-check-input {
            background-color: #ffffff;
            border-color: #d0d0d0;
        }

        .form-check-input:checked {
            background-color: #2c2c2c;
            border-color: #1a1a1a;
        }

        .selected-sizes span {
            color: #2c2c2c;
            font-weight: 500;
        }

        .custom-input-group {
            margin-top: 10px;
            display: none;
        }

        .btn-navigation {
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 400;
            transition: all 0.4s ease;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-size: 14px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .btn-next {
            background: linear-gradient(145deg, #2c2c2c, #1a1a1a);
            color: #fff;
            border: none;
        }

        .btn-next:hover {
            background: linear-gradient(145deg, #333333, #262626);
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .btn-prev {
            background-color: #333;
            color: #fff;
            border: none;
        }

        .btn-prev:hover {
            background-color: #444;
            color: #fff;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .btn-submit {
            background: linear-gradient(145deg, #2c2c2c, #1a1a1a);
            color: #fff;
            border: none;
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
            box-shadow: 0 4px 15px rgba(44, 44, 44, 0.3);
            font-family: 'Source Code Pro', monospace;
            letter-spacing: 2px;
            text-transform: uppercase;
            font-size: 14px;
            padding: 12px 35px;
            border-radius: 30px;
            --btn-shine-position: -50%;
            --btn-shine-opacity: 0;
        }

        .btn-submit::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 30px;
            height: 100%;
            background: linear-gradient(to right,
                    rgba(255, 255, 255, 0) 0%,
                    rgba(255, 255, 255, 0.8) 50%,
                    rgba(255, 255, 255, 0) 100%);
            transform: skewX(-25deg);
            transition: all 0.7s ease;
            opacity: var(--btn-shine-opacity);
            left: var(--btn-shine-position);
        }

        @keyframes darkGradient {
            0% {
                background-position: 0% 50%
            }

            50% {
                background-position: 100% 50%
            }

            100% {
                background-position: 0% 50%
            }
        }

        .btn-submit:hover {
            background: linear-gradient(145deg, #333333, #262626);
            color: #fff;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3), 0 4px 10px rgba(44, 44, 44, 0.4);
            letter-spacing: 3px;
        }

        .btn-submit:hover::before {
            opacity: 1;
        }

        .btn-submit:active {
            transform: translateY(-1px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }

        .btn-submit i {
            transition: all 0.3s ease;
            margin-left: 8px;
            font-size: 18px;
            vertical-align: middle;
        }

        .btn-submit:hover i {
            transform: rotate(10deg) scale(1.2);
            color: #ffffff;
        }

        .required-field::after {
            content: " *";
            color: #2c2c2c;
            font-weight: bold;
            font-size: 1.2em;
            position: relative;
            top: 2px;
        }

        .file-upload-container {
            border: 2px dashed #d0d0d0;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.4s ease;
            display: flex;
            flex-direction: column;
            background-color: rgba(248, 248, 248, 0.9);
            position: relative;
            overflow: hidden;
        }

        .file-upload-container:hover {
            border-color: #2c2c2c;
            background-color: rgba(240, 240, 240, 1);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .file-upload-container::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            width: 40px;
            height: 40px;
            background-color: rgba(44, 44, 44, 0.1);
            border-radius: 50%;
            transform: scale(0);
            transition: all 0.5s ease;
        }

        .file-upload-container:hover::before {
            transform: scale(10);
        }

        .upload-content {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .file-preview-container {
            margin-top: 20px;
            display: none;
            max-width: 100%;
            text-align: center;
        }

        .file-preview {
            max-width: 100%;
            max-height: 200px;
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            border: 1px solid #333;
            transition: transform 0.3s ease;
        }

        .file-preview:hover {
            transform: scale(1.02);
        }

        .file-upload-icon {
            font-size: 40px;
            color: #2c2c2c;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .file-upload-container:hover .file-upload-icon {
            transform: translateY(-5px);
        }

        .file-name {
            font-size: 14px;
            color: #d5d5d5;
            margin-top: 10px;
            font-weight: 400;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .logo {
            max-width: 180px;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(44, 44, 44, 0.3);
            transition: all 0.5s ease;
            filter: brightness(1.05);
        }

        .logo:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5), 0 0 20px rgba(44, 44, 44, 0.3);
        }

        .logo-container::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 2px;
            background: linear-gradient(90deg, transparent, #2c2c2c, transparent);
            margin-top: 15px;
        }

        .border {
            border-color: #e0e0e0 !important;
        }

        .bg-secondary-subtle {
            background-color: rgba(248, 248, 248, 0.9) !important;
        }

        .text-muted {
            color: #888888 !important;
        }

        .list-group-item {
            background-color: rgba(255, 255, 255, 0.95);
            color: #2c2c2c;
            border-color: #e0e0e0;
            transition: all 0.3s ease;
        }

        .list-group-item:hover {
            background-color: rgba(245, 245, 245, 1);
            transform: translateX(3px);
        }

        /* Form Group Styling for Better Separation */
        .mb-3 {
            margin-bottom: 25px !important;
            position: relative;
        }

        /* Add hover effect to label for better interaction */
        .form-label:hover {
            transform: translateX(3px);
            color: #1a1a1a;
        }

        /* Enhanced checkbox styling to match label design */
        .form-check-label {
            color: #2c2c2c;
            transition: all 0.3s ease;
        }

        .form-check-label:hover {
            color: #1a1a1a;
        }

        /* Add some visual indicator when focusing on inputs */
        .form-control:focus+label,
        .form-select:focus+label {
            color: #1a1a1a;
            transform: translateX(3px);
        }

        /* Luxury Dark Animation */
        @keyframes darkShine {
            0% {
                filter: brightness(1);
            }

            50% {
                filter: brightness(1.2);
            }

            100% {
                filter: brightness(1);
            }
        }

        .dark-shine {
            animation: darkShine 3s infinite;
        }

        .btn-danger {
            background-color: #d32f2f;
            border-color: #c62828;
        }

        .btn-danger:hover {
            background-color: #b71c1c;
            border-color: #b71c1c;
        }

        .text-primary {
            color: #2c2c2c !important;
        }

        .navbar {
            margin-bottom: 20px;
            padding: 15px 0;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
            background-color: rgba(255, 255, 255, 0.95) !important;
            border-bottom: 1px solid #e0e0e0 !important;
            position: relative;
        }

        .navbar::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #2c2c2c, transparent);
        }

        .navbar-brand {
            font-family: 'Source Code Pro', monospace;
            font-size: 1.5rem;
            color: #2c2c2c;
            transition: all 0.3s ease;
            letter-spacing: 2px;
        }

        .navbar-brand:hover {
            color: #1a1a1a;
            text-shadow: 0 0 10px rgba(44, 44, 44, 0.3);
        }

        .navbar-logo {
            height: 45px;
            width: auto;
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            transition: all 0.4s ease;
            border: 1px solid rgba(44, 44, 44, 0.3);
        }

        .navbar-brand:hover .navbar-logo {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5), 0 0 15px rgba(44, 44, 44, 0.3);
        }

        .size-checkboxes {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .form-check-input.is-valid~.form-check-label,
        .was-validated .form-check-input:valid~.form-check-label {
            color: #2c2c2c;
        }

        .form-check-input.is-valid,
        .was-validated .form-check-input:valid {
            background-color: #ffffff;
            border-color: #d0d0d0;
        }

        /* Confirmation Screen Styles */
        .success-icon-container {
            display: inline-block;
            background: rgba(248, 248, 248, 0.9);
            border-radius: 50%;
            width: 120px;
            height: 120px;
            line-height: 120px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15), 0 0 20px rgba(44, 44, 44, 0.1);
            position: relative;
            animation: successPulse 2s infinite;
        }

        .success-icon-container::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 50%;
            border: 2px solid rgba(44, 44, 44, 0.2);
            animation: successRing 2.5s infinite;
        }

        @keyframes successPulse {
            0% {
                transform: scale(1);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15), 0 0 20px rgba(44, 44, 44, 0.1);
            }

            50% {
                transform: scale(1.05);
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2), 0 0 30px rgba(44, 44, 44, 0.2);
            }

            100% {
                transform: scale(1);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15), 0 0 20px rgba(44, 44, 44, 0.1);
            }
        }

        @keyframes successRing {
            0% {
                transform: scale(1);
                opacity: 0.5;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.3;
            }

            100% {
                transform: scale(1);
                opacity: 0.5;
            }
        }

        .confirmation-details {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .confirmation-details:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .confirmation-info {
            color: #2c2c2c;
        }

        .confirmation-info .detail-item {
            display: flex;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(44, 44, 44, 0.1);
        }

        .confirmation-info .detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .confirmation-info .detail-label {
            width: 40%;
            color: #1a1a1a;
            font-weight: 500;
            padding-right: 15px;
        }

        .confirmation-info .detail-value {
            width: 60%;
            word-break: break-word;
        }

        @media screen and (max-width: 768px) {
            .size-checkboxes {
                grid-template-columns: repeat(2, 1fr);
            }

            .form-container {
                padding: 30px 20px;
            }

            .confirmation-info .detail-item {
                flex-direction: column;
            }

            .confirmation-info .detail-label,
            .confirmation-info .detail-value {
                width: 100%;
            }

            .confirmation-info .detail-label {
                margin-bottom: 5px;
            }
        }

        /* SweetAlert2 Custom Styling */
        .swal2-popup {
            background-color: #e9e9e9;
            border-radius: 12px !important;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15) !important;
            padding: 2rem;
            border: 1px solid #e0e0e0;
            font-family: 'Source Code Pro', 'IBM Plex Sans Thai', monospace, sans-serif;
        }

        .swal2-title {
            color: #2c2c2c !important;
            font-family: 'Source Code Pro', monospace;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .swal2-html-container {
            color: #4a4a4a !important;
            font-family: 'Source Code Pro', 'IBM Plex Sans Thai', monospace, sans-serif;
        }

        .swal2-icon.swal2-error {
            border-color: #d32f2f !important;
            color: #d32f2f !important;
        }

        .swal2-icon.swal2-success {
            border-color: #2c2c2c !important;
            color: #2c2c2c !important;
        }

        .swal2-icon.swal2-success [class^=swal2-success-line] {
            background-color: #2c2c2c !important;
        }

        .swal2-icon.swal2-success .swal2-success-ring {
            border-color: rgba(44, 44, 44, 0.3) !important;
        }

        .swal2-icon.swal2-info {
            border-color: #2c2c2c !important;
            color: #2c2c2c !important;
        }

        .swal2-icon.swal2-warning {
            border-color: #2c2c2c !important;
            color: #2c2c2c !important;
        }

        .swal2-icon.swal2-question {
            border-color: #2c2c2c !important;
            color: #2c2c2c !important;
        }

        .swal2-confirm {
            background: linear-gradient(145deg, #2c2c2c, #1a1a1a) !important;
            color: #fff !important;
            border: none !important;
            border-radius: 30px !important;
            font-weight: 400 !important;
            letter-spacing: 1px !important;
            text-transform: uppercase !important;
            font-size: 14px !important;
            padding: 12px 30px !important;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2) !important;
            transition: all 0.4s ease !important;
        }

        .swal2-confirm:hover {
            background: linear-gradient(145deg, #333333, #262626) !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3) !important;
        }

        .swal2-cancel {
            background-color: #333 !important;
            color: #fff !important;
            border: none !important;
            border-radius: 30px !important;
            font-weight: 400 !important;
            letter-spacing: 1px !important;
            text-transform: uppercase !important;
            font-size: 14px !important;
            padding: 12px 30px !important;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2) !important;
            transition: all 0.4s ease !important;
        }

        .swal2-cancel:hover {
            background-color: #444 !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3) !important;
        }

        .swal2-styled:focus {
            box-shadow: none !important;
        }

        .swal2-timer-progress-bar {
            background: linear-gradient(90deg, #2c2c2c, #1a1a1a, #333333, #2c2c2c) !important;
            background-size: 200% 100% !important;
            animation: darkGradient 2s linear infinite !important;
        }

        .swal2-loader {
            border-color: #2c2c2c transparent #2c2c2c transparent !important;
        }

        .swal2-close {
            color: #2c2c2c !important;
            transition: all 0.3s ease !important;
        }

        .swal2-close:hover {
            color: #1a1a1a !important;
            transform: scale(1.1) !important;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center ms-auto me-auto" href="#">
                <img src="https://img2.pic.in.th/pic/logob1b822e17a00f2d7.jpg" alt="maison KEEPS Logo"
                    class="navbar-logo me-3" style="height: 40px; width: auto;">
                <span style="font-weight: 400; letter-spacing: 2px;">maison <span
                        style="font-weight: 100; color: #2c2c2c;">KEEPS</span></span>
            </a>
        </div>
    </nav>
    <div class="container">
        <div class="form-container" data-aos="fade-up" data-aos-duration="1200">
            <div class="logo-container">
                <div class="position-relative">
                    <div
                        style="width: 50px; height: 1px; background: linear-gradient(90deg, transparent, #2c2c2c, transparent); position: absolute; top: -15px; left: 50%; transform: translateX(-50%);">
                    </div>
                    <img src="https://img2.pic.in.th/pic/logob1b822e17a00f2d7.jpg" alt="maison KEEPS Logo" class="logo">
                    <div
                        style="width: 50px; height: 1px; background: linear-gradient(90deg, transparent, #2c2c2c, transparent); position: absolute; bottom: -15px; left: 50%; transform: translateX(-50%);">
                    </div>
                </div>
            </div>
            <h1 class="form-title">Design Submit</h1>
            <!-- <p class="text-center mb-4" style="color: #B3A369; font-weight: 300; font-style: italic; font-family: 'Playfair Display', serif;">Crafting elegance with precision and passion</p> -->

            <div class="row steps-container">
                <div class="col-6">
                    <div class="step active" id="step1-indicator">1</div>
                    <div class="step-title active">Product Information</div>
                </div>
                <div class="col-6">
                    <div class="step" id="step2-indicator">2</div>
                    <div class="step-title">Attach Files</div>
                </div>
            </div>

            <form id="designForm">
                <!-- Step 1: Product Information -->
                <div class="form-step active" id="step1">
                    <h3 class="form-subtitle">Product Information</h3>

                    <div class="mb-3">
                        <label for="brandName" class="form-label required-field">Brand Name</label>
                        <select class="form-select shadow-0" id="brandName" required>
                            <option value="" selected disabled>Select Brand Name</option>
                            <? options.brands.forEach( brand => { ?>
                            <option value="<?= brand ?>">
                                <?= brand ?>
                            </option>
                            <? } ) ?>
                            <option value="other">Other</option>
                        </select>
                        <div class="custom-input-group" id="brandNameCustomGroup">
                            <input type="text" class="form-control" id="brandNameCustom" placeholder="Enter Brand Name">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกชื่อแบรนด์
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="mainProductCategory" class="form-label required-field">Main Product Category</label>
                        <select class="form-select" id="mainProductCategory" required>
                            <option value="" selected disabled>Select Main Product Category</option>
                            <? Object.keys(options.mainProducts).forEach(function (category) { ?>
                            <option value="<?= category ?>">
                                <?= category ?>
                            </option>
                            <? }) ?>
                            <!-- <option value="other">Other</option> -->
                        </select>
                        <div class="custom-input-group" id="mainProductCategoryCustomGroup">
                            <input type="text" class="form-control" id="mainProductCategoryCustom"
                                placeholder="Enter Main Product Category">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกหมวดหมู่หลักของสินค้า
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="subProductCategory" class="form-label required-field">Sub Product Category</label>
                        <select class="form-select" id="subProductCategory">
                            <option value="" selected disabled>Select Sub Product Category</option>
                        </select>
                        <div class="custom-input-group" id="subProductCategoryCustomGroup">
                            <input type="text" class="form-control" id="subProductCategoryCustom"
                                placeholder="Enter Sub Product Category">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกหมวดหมู่ย่อยของสินค้า
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label required-field">Type</label>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="productType" id="typeNew" value="New"
                                checked required>
                            <label class="form-check-label" for="typeNew">
                                New
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="productType" id="typeExtension"
                                value="Extension" required>
                            <label class="form-check-label" for="typeExtension">
                                Extension
                            </label>
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกประเภทของสินค้า
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="productName" class="form-label required-field">Product Name</label>
                        <select class="form-select" id="productName" required>
                            <option value="" selected disabled>Select Product Name</option>
                            <? options.productsName.forEach(function (product) { ?>
                            <option value="<?= product ?>">
                                <?= product ?>
                            </option>
                            <? }) ?>
                            <option value="other">Other</option>
                        </select>
                        <div class="custom-input-group" id="productNameCustomGroup">
                            <input type="text" class="form-control" id="productNameCustom"
                                placeholder="Enter Product Name">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกชื่อสินค้า
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="colorOne" class="form-label required-field">Color #1</label>
                        <select class="form-select" id="colorOne" required>
                            <option value="" selected disabled>Select Color</option>
                            <? options.colors1.forEach(function (color) { ?>
                            <option value="<?= color ?>">
                                <?= color ?>
                            </option>
                            <? }) ?>
                            <option value="other">Other</option>
                        </select>
                        <div class="custom-input-group" id="colorOneCustomGroup">
                            <input type="text" class="form-control" id="colorOneCustom" placeholder="Enter Color">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกสีที่ 1
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="colorTwo" class="form-label">Color #2 (Optional)</label>
                        <select class="form-select" id="colorTwo">
                            <option value="" selected>Select Color (Optional)</option>
                            <? options.colors2.forEach(function (color) { ?>
                            <option value="<?= color ?>">
                                <?= color ?>
                            </option>
                            <? }) ?>
                            <option value="other">Other</option>
                        </select>
                        <div class="custom-input-group" id="colorTwoCustomGroup">
                            <input type="text" class="form-control" id="colorTwoCustom" placeholder="Enter Color">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกสีที่ 2
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="technique" class="form-label required-field">Technique</label>
                        <select class="form-select" id="technique" required>
                            <option value="" selected disabled>Select Technique</option>
                            <? options.techniques.forEach(function (technique) { ?>
                            <option value="<?= technique ?>">
                                <?= technique ?>
                            </option>
                            <? }) ?>
                            <option value="other">Other</option>
                        </select>
                        <div class="custom-input-group" id="techniqueCustomGroup">
                            <input type="text" class="form-control" id="techniqueCustom" placeholder="Enter Technique">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกหรือกรอกเทคนิคการผลิต
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label required-field">Size</label>
                        <div class="size-checkboxes">
                            <? options.sizes.forEach(function (size) { ?>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" name="size" id="size<?= size ?>"
                                    value="<?= size ?>">
                                <label class="form-check-label" for="size<?= size ?>">
                                    <?= size ?>
                                </label>
                            </div>
                            <? }) ?>
                        </div>
                        <div class="form-check mt-2">
                            <input class="form-check-input" type="checkbox" id="otherSizeCheck" value="other">
                            <label class="form-check-label" for="otherSizeCheck">
                                Other
                            </label>
                        </div>
                        <div class="custom-input-group" id="sizeCustomGroup">
                            <input type="text" class="form-control" id="sizeCustom" placeholder="Enter Size">
                        </div>
                        <div class="invalid-feedback">
                            กรุณาเลือกขนาดอย่างน้อยหนึ่งขนาด
                        </div>
                        <div class="selected-sizes mt-2">
                            <small class="text-muted">Selected sizes: <span id="selectedSizesText">None</span></small>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="productFor" class="form-label required-field">For</label>
                        <select class="form-select" id="productFor" required>
                            <option value="" selected disabled>Select For</option>
                            <? options.productFor.forEach(function (group) { ?>
                            <option value="<?= group ?>">
                                <?= group ?>
                            </option>
                            <? }) ?>
                        </select>
                        <div class="invalid-feedback">
                            กรุณาเลือกกลุ่มเป้าหมาย
                        </div>
                    </div>

                    <div class="d-flex justify-content-end mt-4">
                        <button type="button" class="btn btn-navigation btn-next" id="nextStep">Next <i
                                class="bi bi-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Attach Files -->
                <div class="form-step " id="step2">
                    <h3 class="form-subtitle">Attach Files</h3>
                    <div class="border rounded p-3 mb-4">
                        <label class="form-label required-field">Product Packshot</label>
                        <div class="rounded-3 border bg-secondary-subtle p-1 text-center" style="cursor: pointer;"
                            id="image-label">
                            <i class="bi bi-cloud-arrow-up-fill text-primary me-2"></i>
                            <span class="uploadLabel">Click to select Files</spam>
                        </div>
                        <input type="file" class="d-none" id="packshotFile" multiple>
                        <input type="file" id="packshotFileHandle" multiple required hidden>

                        <div id="packshotFileList" class="mt-3">
                            <p class="text-muted">No file selected</p>
                        </div>
                        <div class="invalid-feedback">
                            กรุณาอัปโหลดภาพผลิตภัณฑ์อย่างน้อยหนึ่งรูป
                        </div>
                    </div>
                    <div class="border rounded p-3 mb-4">
                        <label class="form-label required-field">ใบคอนเฟิร์มผลิต</label>
                        <div class="rounded-3 border bg-secondary-subtle p-1 text-center" style="cursor: pointer;"
                            id="confirmation-label">
                            <i class="bi bi-cloud-arrow-up-fill text-primary me-3"></i>
                            <span class="uploadLabel">Click to select Files</span>
                        </div>
                        <input type="file" class="d-none" id="confirmationFile" multiple>
                        <input type="file" id="confirmationFileHandle" multiple required hidden>
                        <div id="confirmationFileList" class="mt-3">
                            <p class="text-muted">No file selected</p>
                        </div>
                        <div class="invalid-feedback">
                            กรุณาอัปโหลดไฟล์ใบคอนเฟิร์มผลิตอย่างน้อยหนึ่งไฟล์
                        </div>
                    </div>
                    <div class="border rounded p-3 mb-4">
                        <label class="form-label">Logo (Optional)</label>
                        <div class="rounded-3 border bg-secondary-subtle p-1 text-center" style="cursor: pointer;"
                            id="logo-label">
                            <i class="bi bi-cloud-arrow-up-fill text-primary me-3"></i>
                            <span class="uploadLabel">Click to select Files</span>
                        </div>
                        <input type="file" class="d-none" id="logoFile" multiple>
                        <input type="file" id="logoFileHandle" multiple hidden>
                        <div id="logoFileList" class="mt-3">
                            <p class="text-muted">No file selected</p>
                        </div>
                        <div class="invalid-feedback">
                            กรุณาอัปโหลดโลโก้หากมี
                        </div>
                    </div>
                    <div class="border rounded p-3 mb-4">
                        <label class="form-label required-field">Size Chart</label>
                        <div class="rounded-3 border bg-secondary-subtle p-1 text-center" style="cursor: pointer;"
                            id="sizeChart-label">
                            <i class="bi bi-cloud-arrow-up-fill text-primary me-3"></i>
                            <span class="uploadLabel">Click to select Files</span>
                        </div>
                        <input type="file" class="d-none" id="sizeChartFile" multiple>
                        <input type="file" id="sizeChartFileHandle" multiple required hidden>
                        <div id="sizeChartFileList" class="mt-3">
                            <p class="text-muted">No file selected</p>
                        </div>
                        <div class="invalid-feedback">
                            กรุณาอัปโหลดไฟล์ตารางขนาดอย่างน้อยหนึ่งไฟล์
                        </div>
                    </div>
                    <div class="border rounded p-3 mb-4">
                        <label for="recorderName" class="form-label required-field">ชื่อผู้บันทึก</label>
                        <input type="text" class="form-control text-primary" id="recorderName"
                            placeholder="กรุณากรอกชื่อผู้บันทึก" required>
                        <div class="invalid-feedback">
                            กรุณากรอกชื่อผู้บันทึก
                        </div>
                    </div>
                    <div class="d-flex justify-content-between mt-4"> <button type="button"
                            class="btn btn-navigation btn-prev" id="prevStep"><i class="bi bi-arrow-left"></i>
                            Previous</button>
                        <button type="button" class="btn btn-navigation btn-submit" id="submitForm">
                            <span class="btn-text">Submit</span> <i class="bi bi-check-circle-fill"></i>
                        </button>
                    </div>
                </div>
            </form>

            <!-- Success Confirmation Screen (initially hidden) -->
            <div id="confirmationScreen" style="display: none;" data-aos="fade-up" data-aos-duration="1200">
                <div class="text-center mb-5">
                    <div class="success-icon-container">
                        <i class="bi bi-check-circle-fill" style="font-size: 5rem; color: #2c2c2c;"></i>
                    </div>
                </div>                <h2 class="text-center mb-4"
                    style="color: #2c2c2c; font-family: 'Source Code Pro', monospace; letter-spacing: 1px;">
                    <span class="thai-text" style="font-family: 'IBM Plex Sans Thai', sans-serif;">บันทึกข้อมูลสำเร็จ</span></h2>
                <p class="text-center mb-4" style="color: #2c2c2c; font-size: 1.1rem;">
                    <span class="thai-text" style="font-family: 'IBM Plex Sans Thai', sans-serif;">ข้อมูลของคุณถูกบันทึกเรียบร้อยแล้ว</span></p>

                <div class="row justify-content-center mb-5">
                    <div class="col-md-8">
                        <div class="confirmation-details p-4 mb-4"
                            style="background-color: rgba(255, 255, 255, 0.9); border-radius: 10px; border: 1px solid #e0e0e0;">                            <h4
                                style="color: #2c2c2c; font-family: 'Source Code Pro', monospace; margin-bottom: 20px; position: relative; padding-bottom: 10px;">
                                <span class="thai-text" style="font-family: 'IBM Plex Sans Thai', sans-serif;">รายละเอียดการบันทึก</span>
                                <span
                                    style="position: absolute; bottom: 0; left: 0; width: 50px; height: 2px; background-color: #2c2c2c;"></span>
                            </h4>
                            <div id="confirmationDetails" class="confirmation-info">
                                <!-- Details will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="text-center">                    <button type="button" id="newFormBtn" class="btn btn-navigation"
                        style="background: linear-gradient(145deg, #2c2c2c, #1a1a1a); color: #fff; border: none; padding: 12px 35px; border-radius: 30px; font-family: 'Source Code Pro', monospace; letter-spacing: 2px; box-shadow: 0 4px 15px rgba(44, 44, 44, 0.3);">
                        <span class="btn-text thai-text" style="font-family: 'IBM Plex Sans Thai', sans-serif;">สร้างฟอร์มใหม่</span> <i class="bi bi-plus-circle-fill ms-2"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <input type="file" id="handleFiles" value="" hidden>
    <script>
        window.addEventListener('DomainLoaded', function () {
            // Initialize NProgress
            NProgress.start();
            NProgress.inc();
        });
        $(document).ready(function () {
            NProgress.done();
            // Initialize AOS
            AOS.init();

            addEventToOtherOptionSelects();
            addEventToFileSelection();

            // Initialize selected sizes text
            updateSelectedSizesText();

            $('select').select2({
                width: '100%',
                theme: 'bootstrap-5'
            });

            // Step navigation
            let currentStep = 1;

            const showStep = function (step) {
                $('.form-step').removeClass('active');
                $(`#step${step}`).addClass('active');

                $('.step').removeClass('active');
                $(`#step${step}-indicator`).addClass('active');
                $('.step-title').removeClass('active');
                $(`#step${step}-indicator`).next('.step-title').addClass('active');
                // Scroll to top when changing steps
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });

                // Enhanced motion effect for step change
                $('.form-step').css('animation', 'fadeIn 0.5s ease-in-out');
            }
            $('#nextStep').click(function () {
                if (currentStep < 2) {
                    // Check if at least one size checkbox is selected or custom size is filled
                    let sizeValid = false;
                    $('input[name="size"]:checked').each(function () {
                        sizeValid = true;
                    });

                    if ($('#otherSizeCheck').is(':checked') && $('#sizeCustom').val()) {
                        sizeValid = true;
                    }

                    if (!sizeValid) {
                        $('.size-checkboxes').siblings('.invalid-feedback').show();
                    } else {
                        $('.size-checkboxes').siblings('.invalid-feedback').hide();
                    }

                    // Check if all required fields in step 1 are filled
                    let valid = true;
                    $('#step1 .form-control, #step1 .form-select').each(function () {
                        if ($(this).prop('required') && !$(this).val()) {
                            valid = false;
                        }
                    });
                    if (!$('input[name="size"]').is(':checked') && !$('#otherSizeCheck').is(':checked')) {
                        valid = false;
                    }
                    if (!valid) {
                        $('#designForm').addClass('was-validated');
                    } else {
                        $('#designForm').removeClass('was-validated');
                        currentStep++;
                        showStep(currentStep);
                    }
                }
            });
            $('#prevStep').click(function () {
                if (currentStep > 1) {
                    currentStep--;
                    showStep(currentStep);
                }
            });

            $('#submitForm').on('click', handleFormSubmission);

            // Handle new form button click
            $('#newFormBtn').click(function () {
                resetForm();
            });
        });

        function addEventToOtherOptionSelects() {
            const otherOptions = [
                { selectId: '#brandName', customInputId: '#brandNameCustom', groupId: '#brandNameCustomGroup' },
                // { selectId: '#mainProductCategory', customInputId: '#mainProductCategoryCustom', groupId: '#mainProductCategoryCustomGroup' },
                // { selectId: '#subProductCategory', customInputId: '#subProductCategoryCustom', groupId: '#subProductCategoryCustomGroup' },
                { selectId: '#productName', customInputId: '#productNameCustom', groupId: '#productNameCustomGroup' },
                { selectId: '#colorOne', customInputId: '#colorOneCustom', groupId: '#colorOneCustomGroup' },
                { selectId: '#colorTwo', customInputId: '#colorTwoCustom', groupId: '#colorTwoCustomGroup' },
                { selectId: '#technique', customInputId: '#techniqueCustom', groupId: '#techniqueCustomGroup' }
            ];

            otherOptions.forEach(option => {
                $(option.selectId).change(function () {
                    if ($(this).val() === 'other') {
                        $(this).removeAttr('required');
                        $(option.customInputId).val('').show().attr('required', true);
                        $(option.groupId).show();
                    } else {
                        $(this).attr('required', true);
                        $(option.customInputId).val('').hide().removeAttr('required');
                        $(option.groupId).hide();
                    }
                });
            });

            $('#mainProductCategory').change(function () {
                const selectedCategory = $(this).val();
                let options = <?!= JSON.stringify(options) ?>;
                // If there's already a Select2 instance on subProductCategory, destroy it first
                if ($('#subProductCategory').data('select2')) {
                    $('#subProductCategory').select2('destroy');
                }

                // Clear existing options
                $('#subProductCategory').empty();
                $('#subProductCategory').append('<option value="" selected disabled>Select Sub Product Category</option>');

                // Add the appropriate sub-categories based on the selected main category
                if (selectedCategory && options.mainProducts[selectedCategory]) {
                    options.mainProducts[selectedCategory].forEach(function(subCategory) {
                        $('#subProductCategory').append(`<option value="${subCategory}">${subCategory}</option>`);
                    });
                }


                // Re-initialize Select2
                $('#subProductCategory').select2({
                    width: '100%',
                    theme: 'bootstrap-5'
                });
                $('#subProductCategory').each(function () {
                    if ($(this).data('main-product') === selectedCategory) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
                $('#subProductCategory').val('').trigger('change');
            });

            // Handle the size "other" checkbox
            $('#otherSizeCheck').change(function () {
                if ($(this).is(':checked')) {
                    $('#sizeCustom').val('').show().attr('required', true);
                    $('#sizeCustomGroup').show();
                } else {
                    $('#sizeCustom').val('').hide().removeAttr('required');
                    $('#sizeCustomGroup').hide();
                }
                updateSelectedSizesText();
            });

            // Handle the size checkboxes
            $('input[name="size"]').change(function () {
                updateSelectedSizesText();
            });

            // Handle the custom size input
            $('#sizeCustom').on('input', function () {

                updateSelectedSizesText();
            });
            // Initialize the Other size input as hidden
            $('#sizeCustomGroup').hide();
        }

        // File upload functionality
        function addEventToFileSelection(fileInputId, labelId, fileListId) {
            const fileSelections = [
                { inputId: '#packshotFile', labelId: '#image-label', listId: '#packshotFileList', handleId: '#packshotFileHandle' },
                { inputId: '#confirmationFile', labelId: '#confirmation-label', listId: '#confirmationFileList', handleId: '#confirmationFileHandle' },
                { inputId: '#logoFile', labelId: '#logo-label', listId: '#logoFileList', handleId: '#logoFileHandle' },
                { inputId: '#sizeChartFile', labelId: '#sizeChart-label', listId: '#sizeChartFileList', handleId: '#sizeChartFileHandle' }
            ];

            fileSelections.forEach(file => {
                $(file.labelId).click(function () {
                    $(file.inputId).click();
                });

                $(file.inputId).change(function () {
                    const files = this.files;
                    if (files.length > 0) {
                        let handle_files = $(file.handleId)[0].files || [];
                        let dt = new DataTransfer();
                        // Create a new DataTransfer object to handle the files
                        for (let i = 0; i < handle_files.length; i++) {
                            dt.items.add(handle_files[i]);
                        }
                        // Add the newly selected files to the DataTransfer object
                        let handle_file_names = Array.from(handle_files).map(f => f.name);
                        for (let i = 0; i < files.length; i++) {
                            let isDuplicate = handle_file_names.includes(files[i].name);

                            if (!isDuplicate) {
                                dt.items.add(files[i]);
                            }
                        }
                        // Update the file input with the new FileList
                        $(file.inputId).val(''); // Clear the input value to allow re-selection of
                        $(file.handleId)[0].files = dt.files;
                        $(file.labelId).find('.uploadLabel').text(`${$(file.handleId)[0].files.length} file(s) selected`);

                        handle_files = $(file.handleId)[0].files;
                        let ul = $('<ul class="list-group"></ul>');
                        for (let i = 0; i < handle_files.length; i++) {
                            const fileName = handle_files[i].name;
                            ul.append(`<li class="list-group-item d-flex justify-content-between align-items-center form-text">
                                ${fileName}
                                <button class="btn btn-danger btn-sm delete-file" data-file-name="${fileName}" data-input="${file.handleId}" data-index="${i}">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </li>`);
                        }
                        $(file.listId).html(ul);

                        // Add event listeners to delete buttons
                        $(file.listId).find('.delete-file').click(function (e) {
                            e.preventDefault();
                            const fileName = $(this).data('file-name');
                            const handleInput = $(this).data('input');
                            const handle_files = $(handleInput)[0].files;
                            let dt = new DataTransfer();
                            for (let j = 0; j < handle_files.length; j++) {
                                if (handle_files[j].name !== fileName) {
                                    dt.items.add(handle_files[j]);
                                }
                            }
                            $(handleInput)[0].files = dt.files;
                            console.log('Updated files:', $(handleInput)[0].files);
                            $(this).closest('li').remove();
                            $(file.labelId).find('.uploadLabel').text(`${$(handleInput)[0].files.length} file(s) selected`);
                            if ($(handleInput)[0].files.length === 0) {
                                $(file.listId).html('<p class="text-muted">No file selected</p>');
                                $(file.labelId).find('.uploadLabel').text('Click to select Files');
                            }

                        });
                    } else {
                        $(file.listId).html('<p class="text-muted">No file selected</p>');
                    }
                });
            });
        }

        function updateSelectedSizesText() {
            $('.size-checkboxes').siblings('.invalid-feedback').hide();
            let selectedSizes = [];

            // Get checked sizes
            $('input[name="size"]:checked').each(function () {
                selectedSizes.push($(this).val());
            });

            // Add custom size if applicable
            if ($('#otherSizeCheck').is(':checked') && $('#sizeCustom').val().trim()) {
                selectedSizes.push($('#sizeCustom').val().trim().toUpperCase());
            }

            // Update the text
            if (selectedSizes.length > 0) {
                $('#selectedSizesText').text(selectedSizes.join(', '));
            } else {
                $('#selectedSizesText').text('None');
            }
        }


        function handleFormSubmission(event) {
            event.preventDefault();
            // Validate the form
            if (!$('#designForm')[0].checkValidity()) {
                $('#designForm').addClass('was-validated');
                if (!$('input[name="size"]:checked').length && !$('#otherSizeCheck').is(':checked')) {
                    $('.size-checkboxes').siblings('.invalid-feedback').show();
                } else {
                    $('.size-checkboxes').siblings('.invalid-feedback').hide();
                }
                console.log($('#designForm')[0].checkValidity());
                return;
            } else {
                $('#designForm').removeClass('was-validated');
            }

            let handle_all_files = [
                { inputId: '#packshotFileHandle', labelId: '#packshotFileList' },
                { inputId: '#confirmationFileHandle', labelId: '#confirmationFileList' },
                { inputId: '#logoFileHandle', labelId: '#logoFileList' },
                { inputId: '#sizeChartFileHandle', labelId: '#sizeChartFileList' }
            ];
            let handleFiles = $('#handleFiles')[0].files || [];
            let dt = new DataTransfer();
            handle_all_files.forEach(file => {
                let handle_files = $(file.inputId)[0].files || [];
                for (let i = 0; i < handle_files.length; i++) {
                    let new_name = file.inputId.replace('#', '').replace('FileHandle', '') + ' - ' + handle_files[i].name;
                    dt.items.add(new File([handle_files[i]], new_name, {
                        type: handle_files[i].type
                    }));
                }
            });
            $('#handleFiles')[0].files = dt.files;
            handleFiles = $('#handleFiles')[0].files;
            if (handleFiles.length === 0) {
                Swal.fire({
                    icon: 'error',
                    title: 'ไม่มีไฟล์ที่เลือก',
                    text: 'กรุณาอเลือกไฟล์ที่บังคับเพื่อดำเนินการต่อ',
                    confirmButtonText: 'ตกลง'
                });
                return;
            }
            uploadFiles().then((res) => {
                let { files, uid } = res;
                console.log('Uploaded files:', files);
                console.log('UID:', uid);
                const getValue = (selector) => {
                    return $(selector).val() === 'other' ? $(selector + 'Custom').val() : $(selector).val();
                };
                const formData = {
                    brandName: getValue('#brandName'),
                    mainProductCategory: getValue('#mainProductCategory'),
                    subProductCategory: getValue('#subProductCategory'),
                    productType: $('input[name="productType"]:checked').val(),
                    productName: getValue('#productName'),
                    colorOne: getValue('#colorOne'),
                    colorTwo: getValue('#colorTwo'),
                    technique: getValue('#technique'),
                    sizes: $('input[name="size"]:checked').map(function () {
                        return $(this).val().trim().toUpperCase();
                    }).toArray().join(', ') + ($('#otherSizeCheck').is(':checked') && $('#sizeCustom').val().trim() ? ', ' + $('#sizeCustom').val().trim().toUpperCase() : ''),
                    productFor: $('#productFor').val(),
                    packshotFiles: files['packshot'] ? files['packshot'].join('\n') : "",
                    confirmationFiles: files['confirmation'] ? files['confirmation'].join('\n') : "",
                    logoFiles: files['logo'] ? files['logo'].join('\n') : "",
                    sizeChartFiles: files['sizeChart'] ? files['sizeChart'].join('\n') : "",
                    recorderName: $('#recorderName').val(),
                };
                console.log('Form Data:', formData);
                NProgress.start();
                NProgress.inc();
                Swal.fire({
                    iconHtml: '<i class="bi bi-check-circle-fill" style="font-size: 3rem; color: #2c2c2c;"></i>',
                    title: 'กำลังบันทึกข้อมูล',
                    allowOutsideClick: false,
                    didOpen: () => {
                        Swal.showLoading()
                    },
                });
                google.script.run.withFailureHandler(e => console.log(e)).withSuccessHandler(e => {
                    e = JSON.parse(e); NProgress.done();
                    if (e.success) {
                        google.script.run.moveFilesToFolder(e.data.file_ids, e.data.folder_id);

                        // Hide the form and show the confirmation screen
                        $('#designForm').hide();

                        // Populate confirmation details
                        let detailsHTML = '';
                        const formDetails = [
                            { label: 'แบรนด์', value: formData.brandName },
                            { label: 'หมวดหมู่หลัก', value: formData.mainProductCategory },
                            { label: 'หมวดหมู่ย่อย', value: formData.subProductCategory },
                            { label: 'ประเภท', value: formData.productType === 'new' ? 'สินค้าใหม่' : 'ต่อยอดจากสินค้าเดิม' },
                            { label: 'ชื่อสินค้า', value: formData.productName },
                            { label: 'สี 1', value: formData.colorOne },
                            { label: 'สี 2', value: formData.colorTwo || '-' },
                            { label: 'เทคนิค', value: formData.technique },
                            { label: 'ไซส์', value: formData.sizes },
                            { label: 'สำหรับ', value: formData.productFor },
                            { label: 'ชื่อผู้บันทึก', value: formData.recorderName }
                        ];                        formDetails.forEach(detail => {
                            detailsHTML += `
                            <div class="detail-item">
                                <div class="detail-label thai-text" style="font-family: 'IBM Plex Sans Thai', sans-serif;">${detail.label}</div>
                                <div class="detail-value thai-text" style="font-family: 'IBM Plex Sans Thai', sans-serif;">${detail.value}</div>
                            </div>`;
                        });

                        $('#confirmationDetails').html(detailsHTML);

                        // Show confirmation screen with animation
                        $('#confirmationScreen').fadeIn(800);

                        // Scroll to top of confirmation
                        $('html, body').animate({
                            scrollTop: $('#confirmationScreen').offset().top - 100
                        }, 800);

                        // Initialize new form button
                        $('#newFormBtn').on('click', function () {
                            resetForm();
                        }); Swal.fire({
                            icon: 'success',
                            title: 'บันทึกข้อมูลสำเร็จ',
                            text: 'ข้อมูลของคุณถูกบันทึกเรียบร้อยแล้ว',
                            confirmButtonText: 'ตกลง'
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'เกิดข้อผิดพลาด',
                            text: e.message,
                            confirmButtonText: 'ตกลง'
                        });
                    }
                }).saveDesignData(formData);
            }).catch((err) => {
                Swal.fire({
                    icon: 'error',
                    title: 'เกิดข้อผิดพลาด',
                    text: err,
                    confirmButtonText: 'ตกลง'
                });
            });

        }

        async function uploadFiles() {
            const f = document.getElementById("handleFiles");
            if (f.files.length == 0) {
                return []
            }
            NProgress.start();
            NProgress.inc();
            Swal.fire({
                iconHtml: '<i class="bi bi-cloud-arrow-up-fill" style="font-size: 3rem; color: #2c2c2c;"></i>',
                title: 'กำลังอัพโหลดไฟล์',
                allowOutsideClick: false,
                html: '<div class="container-fluid"><div class="row" id="progress"></div></div>',
                didOpen: () => {
                    Swal.showLoading()
                },
            })

            const { token, folder_id } = await getDownloadToken();
            let file = await new Promise((resolve, reject) => {
                let length = f.files.length;
                let count = 0;
                let uploadfiles = [];
                [...f.files].forEach((file, i) => {
                    let fr = new FileReader();
                    fr.fileName = file.name;
                    fr.fileSize = file.size;
                    fr.fileType = file.type;
                    fr.readAsArrayBuffer(file);
                    fr.onload = e => {
                        var id = "p" + ++i;
                        var div = $("<div>", { class: 'col-12 text-truncate mb-2' });
                        div.attr("id", id);
                        $("#progress").append(div);
                        $('#' + id).text('Initialising (' + fr.fileName + ')')
                        const f = e.target;
                        const resource = {
                            fileName: f.fileName,
                            fileSize: f.fileSize,
                            fileType: f.fileType,
                            fileBuffer: f.result,
                            accessToken: token,
                            folderId: folder_id,
                            fields: "id, name"
                        };
                        const ru = new ResumableUploadToGoogleDrive();
                        ru.Do(resource, function (res, err) {
                            if (err) {
                                console.log(err);
                                return;
                            }
                            console.log(res);
                            let msg = "";
                            if (res.status == 'start' || res.status == 'getLocation' || res.status == 'initialize') {
                                msg = '<i class="bi bi-cloud-arrow-up-fill me-2" style="color: #2c2c2c;"></i> กำลังเตรียมอัพโหลด ' + f.fileName;
                            }
                            else if (res.status == "Uploading") {
                                msg =
                                    '<i class="bi bi-hourglass-split me-2" style="color: #2c2c2c;"></i> กำลังอัพโหลด ' +
                                    Math.round(
                                        (res.progressNumber.current / res.progressNumber.end) * 100
                                    ) +
                                    "% (" +
                                    f.fileName +
                                    ")";
                            } else {
                                msg = '<i class="bi bi-check-circle-fill me-2" style="color: #2c2c2c;"></i> อัพโหลดสำเร็จ  (' + f.fileName + ")";
                            }

                            // If you want to put the uploaded file information to the active Spreadsheet,
                            // please use the following function.
                            if (res.status == "Done") {
                                uploadfiles.push({
                                    id: res.result.id,
                                    name: res.result.name
                                });
                                if (uploadfiles.length == length) {
                                    resolve(uploadfiles);
                                }
                            }

                            $('#' + id).html(msg)
                        });
                    };
                });
            });
            NProgress.done();
            console.log('Uploaded files:', file);
            return {
                files: file.reduce((acc, curr) => {
                    let name = curr.name.split(' - ')[0];
                    if (!acc[name]) {
                        acc[name] = [];
                    }
                    acc[name].push('https://drive.google.com/uc?id=' + curr.id);
                    return acc;
                }, {}),
                folder_id: folder_id
            }
        }

        function getDownloadToken() {
            return new Promise((resolve, reject) => {
                google.script.run.withSuccessHandler((res) => {
                    res = JSON.parse(res);
                    if (res.success) {
                        resolve(res.data);
                    } else {
                        reject(res.message);
                    }
                }).getDownloadToken();
            });
        }



    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/locale/th.js"></script>
    <script src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script
        src="https://cdn.jsdelivr.net/gh/tanaikech/ResumableUploadForGoogleDrive_js@master/resumableupload_js.min.js">
        </script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.full.min.js"></script>
    <script>
        function resetForm() {

            window.open("<?= options.resetUrl ?>", '_top');
        }
        // Initialize AOS with enhanced settings
        AOS.init({
            duration: 1200,
            easing: 'ease-out-cubic',
            once: false,
            mirror: true
        });

        // Add subtle hover effects to form elements
        document.addEventListener('DOMContentLoaded', function () {
            // Add hover animation to form fields
            const formFields = document.querySelectorAll('.form-control, .form-select');
            formFields.forEach(field => {
                field.addEventListener('focus', function () {
                    this.style.transition = 'all 0.4s ease';
                    this.style.transform = 'translateY(-2px)';

                    // Find the associated label and enhance it
                    const formGroup = this.closest('.mb-3');
                    if (formGroup) {
                        const label = formGroup.querySelector('.form-label');
                        if (label) {
                            label.style.color = '#1a1a1a';
                            label.style.transform = 'perspective(100px) translateZ(10px) translateX(5px)';
                            label.style.textShadow = '2px 2px 4px rgba(0,0,0,0.7)';
                        }
                    }
                });

                field.addEventListener('blur', function () {
                    this.style.transform = 'translateY(0)';

                    // Reset the label styling
                    const formGroup = this.closest('.mb-3');
                    if (formGroup) {
                        const label = formGroup.querySelector('.form-label');
                        if (label) {
                            label.style.color = '';
                            label.style.transform = '';
                            label.style.textShadow = '';
                        }
                    }
                });
            });

            // Add subtle dark shine effect to the logo
            const logo = document.querySelector('.logo');
            if (logo) {
                setInterval(() => {
                    logo.style.filter = 'brightness(1.1)';
                    setTimeout(() => {
                        logo.style.filter = 'brightness(1.05)';
                    }, 1000);
                }, 3000);
            }

            // Add pulsating effect to submit button
            const submitBtn = document.querySelector('.btn-submit');
            if (submitBtn) {
                // Initial subtle pulsate animation
                setTimeout(() => {
                    const pulseAnimation = () => {
                        submitBtn.animate([
                            { boxShadow: '0 4px 15px rgba(44, 44, 44, 0.3)' },
                            { boxShadow: '0 4px 20px rgba(44, 44, 44, 0.6)' },
                            { boxShadow: '0 4px 15px rgba(44, 44, 44, 0.3)' }
                        ], {
                            duration: 2000,
                            iterations: Infinity
                        });
                    };
                    pulseAnimation();

                    // Add elegant shine effect on hover
                    submitBtn.addEventListener('mouseover', function () {
                        this.style.setProperty('--btn-shine-opacity', '1');
                        setTimeout(() => {
                            if (this.matches(':hover')) {
                                this.style.setProperty('--btn-shine-position', '150%');
                            }
                        }, 100);
                    });

                    submitBtn.addEventListener('mouseout', function () {
                        this.style.setProperty('--btn-shine-opacity', '0');
                        this.style.setProperty('--btn-shine-position', '-50%');
                    });
                }, 2000);
            }
        });
    </script>
</body>

</html>