<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="cache-control" content="Public" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:description" content="ใช้สำหรับแชร์ข้อมูลผ่าน LIFF" />
  <meta property="og:title" content="LIFF Shared" />
  <meta property="og:image" content="https://firebasestorage.googleapis.com/v0/b/addbot-fc308.appspot.com/o/%E0%B8%A3%E0%B8%B9%E0%B8%9B%201%2FS__6553743.jpg?alt=media&token=89c14287-c92a-416d-b0e0-f12c103263d4" />
  <title>LIFF Share Flex</title>
  <script>
    document.write('<link rel="stylesheet" href="testkrit.css?cache=' + new Date().getTime() + '">')
  </script>
  <script>
    document.write('<script defer src="testkrit.js?cache=' + new Date().getTime() + '"><\/script>')
  </script>
</head>

<body id="body">
  <center>
    <h1 style="font-size:5vw; color:red">LIFF Shared</h1>
  </center>
  <button style="font-size: 4vw; border-radius:10px; text-align:center; line-height:1em;" id="back">
    Back
  </button>
  <center>
    <button style="color:white; font-size:4vw" class="block" id="login" onclick="liff.login()">
      Login
    </button>
  </center>
  <div id="radioGroup">
    <center>
      <input type="radio" id="myCheck2" name="check" value="template" checked="true" style="height:4vw; width:4vw;" onchange="selectFunction(0);" />
      <label for="myCheck2" style="font-size: 4vw;">ใช้รูปแบบปกติ </label>
      <input type="radio" id="myCheck" name="check" value="custom" style="height:4vw; width:4vw;" onchange="selectFunction(1);" />
      <label for="myCheck" style="font-size: 4vw;">กำหนดรูปแบบเอง</label><br /><br />
    </center>
  </div>
  <div id="liffBody">
    <center>
      <div id="customFlex">
        <label for="flexBox" style="font-size: 4vw;">message : </label>
        <input style="font-size: 4vw;" id="flexBox" type="text" value="" />
        <button id="options" style="font-size: 4vw; border-radius:10px; text-align:center; line-height:1em;">
          ...
        </button>
      </div>
      <div id="templateFlex">
        <div id="inputSection">
          <label for="imageLink" style="font-size: 4vw;">ลิ้งค์รูปภาพ :
          </label>
          <input style="font-size: 4vw;" id="imageLink" type="text" value="" oninput="showImage()" />
          <button id="uploadOptions" style="font-size: 3vw; border-radius:10px; text-align:center; line-height:1em;"
            onclick="document.getElementById('uploadSection').style.display ='block'; document.getElementById('inputSection').style.display ='none'">
            upload</button><br /><br />
        </div>
        <div id="uploadSection">
          <center>
            <label for="uploadImg" style="font-size: 4vw;">อัพโหลดรูปภาพ :
            </label>
            <input type="file" id="uploadImg" name="uploadImg" accept="image/*" onchange="preview_image(event)" style="font-size: 3vw;" />
            <button id="uploadOptions" style="font-size: 3vw; border-radius:10px; text-align:center; line-height:1em;"
              onclick="document.getElementById('uploadSection').style.display ='none'; document.getElementById('inputSection').style.display ='block'">
              ใส่ Url</button><br /><br />
          </center>
        </div>
        <center>
          <div id="img"><img id="image" alt="Example" /><br /><br /></div>
        </center>
        <label for="headingMessage" style="font-size: 4vw;">ข้อความหัวข้อ :
        </label>
        <input style="font-size: 4vw;" id="headingMessage" type="text" value="" /><br /><br />
        <label for="bodyMessage" style="font-size: 4vw;">ข้อความเนื้อหา :
        </label>
        <input style="font-size: 4vw;" id="bodyMessage" type="text" value="" /><br /><br />
        <label for="link" style="font-size: 4vw;">ลิ้งค์เพิ่มเติม : </label>
        <input style="font-size: 4vw;" id="linkUrl" type="text" value="" /><br /><br />
      </div>
    </center>
    <div id="liffAppContent">
      <br /><br />
      <!-- ACTION BUTTONS -->
      <input type="checkbox" name="canShared" id="canShared" style="height:4vw; width:4vw;">
      <label for="canShared" style="font-size:4vw">ทำให้สามารถแชร์ต่อได้</label>
      <div class="buttonGroup">
        <div class="buttonRow">
          <center>
            <button id="shareButton" class="block2" style="color:white; font-size:4vw" onclick="validateImage('share')">
              Share to other Chats</button><br />
            <button id="sendMessageButton" class="block2" style="color:white; font-size:4vw" onclick="validateImage('send')">
              Send in this Chat
            </button>
          </center>
        </div>
      </div>
    </div>
  </div>
  <div id="liffBody2" style="display: none;">
    <br /><br />
    <div class="buttonColumn">
      <!------------------------------เพิ่ม ----------------------- -->
      <!------------------------------หรือ ----------------------- -->
      <!----------------------------ปรับแต่ง ---------------------- -->
      <!------------------------------ปุ่ม ------------------------ -->
      <!------------------------------ตรงนี้ ---------------------- -->
      <center>
        <button id="shareRoomSelect" style="font-size:3.5vw; color:white" class="block2" onclick="sendTemplatFlex(1)">
          ส่งรายชื่อห้องแชท 6 ห้อง</button><br /><br />
        <button id="linkAnswer" style="font-size:3.5vw; color:white" class="block2" onclick="sendTemplatFlex(2)">
          ส่งคำตอบแนบลิ้งค์</button><br /><br />
        <button id="youtubeLink" class="block2" style="font-size:3.5vw; color:white" class="block" onclick="sendTemplatFlex(3)">
          ส่งลิ้งค์ Youtube</button><br /><br />
        <button id="ebookAds" class="block2" style="font-size:3.5vw; color:white" class="block" onclick="sendTemplatFlex(4)">
          โฆษณา E-book</button><br />

        <button id="registerProcess" style="font-size:3.5vw; color:white" class="block2" onclick="sendTemplatFlex(5)">
          แนะนำการลงทะเบียน</button><br /><br />
        <button id="zoomTopic" style="font-size:3.5vw; color:white" class="block2" onclick="sendTemplatFlex(6)">
          แจ้งหัวข้อZoom</button><br /><br />
        <button id="temp7" class="block2" style="font-size:3.5vw; color:white" onclick="sendTemplatFlex(7)">
          เชิญเข้ากลุ่มใหม่</button><br /><br />
        <button id="temp8" class="disableblock" style="font-size:3.5vw; color:white">
          ปุ่ม8</button><br />
      </center>
    </div>
  </div>
  <br /><br /><br /><br />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/versions/2.5.0/sdk.js"></script>
  <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
  <script>
    // VConsole 默认会挂载到 `window.VConsole` 上
    var vConsole = new window.VConsole();
  </script>
  <script>
    var body = document.getElementById("liffBody").innerHTML;
    document.getElementById("options").addEventListener("click", function () {
      document.getElementById("back").style.display = "block";
      document.getElementById("radioGroup").style.display = "none";
      document.getElementById("liffBody").style.display = "none";
      document.getElementById("liffBody2").style.display = "block";
    });
    document.getElementById("back").addEventListener("click", function () {
      document.getElementById("back").style.display = "none";
      document.getElementById("radioGroup").style.display = "block";
      document.getElementById("liffBody").style.display = "block";
      document.getElementById("liffBody2").style.display = "none";
    });

    function selectFunction(num) {
      if (num == 0) {
        document.getElementById("back").style.display = "none";
        document.getElementById("customFlex").style.display = "none";
        document.getElementById("templateFlex").style.display = "block";
      } else {
        document.getElementById("customFlex").style.display = "block";
        document.getElementById("templateFlex").style.display = "none";
      }
    }
    async function validateImage(button) {
      var imgUrl = document.getElementById("imageLink").value;
      if (
        document.getElementById("headingMessage").value == "" &&
        document.getElementById("bodyMessage").value == "" &&
        document.getElementById("customFlex").style.display == "none"
      ) {
        alert('คุณต้องกรอก "ข้อความ" อย่างน้อย 1 ช่อง');
      } else if (
        document.getElementById("inputSection").style.display == "none" &&
        document.getElementById("uploadSection").style.display == "block" &&
        document.getElementById("customFlex").style.display == "none"
      ) {
        if (button == "send") {
          await uploadImage("send");
        } else {
          await uploadImage("share");
        }
      } else if (
        document.getElementById("inputSection").style.display == "block" &&
        document.getElementById("uploadSection").style.display == "none" &&
        document.getElementById("customFlex").style.display == "none"
      ) {
        if (imgUrl.length > 0) {
          if (!imgUrl.startsWith("https")) {
            alert("กรุณาใช้ url รูปภาพที่เป็น https");
          } else {
            if (button == "send") {
              sendClick();
            } else {
              shareClick();
            }
          }
        } else {
          if (button == "send") {
            sendClick();
          } else {
            shareClick();
          }
        }
      } else {
        if (button == "send") {
          sendClick();
        } else {
          shareClick();
        }
      }
    }

    function showImage() {
      if (
        document.getElementById("img").style.display == "none" &&
        document.getElementById("imageLink").value != ""
      ) {
        document.getElementById("img").style.display = "block";
      } else if (document.getElementById("imageLink").value == "") {
        document.getElementById("img").style.display = "none";
      }
      document.getElementById("image").src = document.getElementById(
        "imageLink"
      ).value;
    }

    function preview_image(event) {
      document.getElementById("img").style.display = "block";
      var reader = new FileReader();
      reader.onload = function () {
        var output = document.getElementById("image");
        output.src = reader.result;
        document.getElementById("imageLink").value == reader.result;
      };
      reader.readAsDataURL(event.target.files[0]);
    }
  </script>
</body>
<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-storage.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.2.2/firebase-analytics.js"></script>
<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyDdPZODpIJy3xN9PjDE4tjRlH4lzaedSmQ",
    authDomain: "addbot-fc308.firebaseapp.com",
    databaseURL: "https://addbot-fc308.firebaseio.com",
    projectId: "addbot-fc308",
    storageBucket: "addbot-fc308.appspot.com",
    messagingSenderId: "358755894493",
    appId: "1:358755894493:web:40b6ad19771c4410358734",
    measurementId: "G-GV70WW8XD6"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  console.log(firebase);
  firebase.analytics();
  async function uploadImage(button) {
    document.getElementById("img").innerHTML =
      '<center><div class="loader"></div></center>';
    const ref = firebase.storage().ref("temp_image");
    const file = document.querySelector("#uploadImg").files[0];
    const metadata = {
      contentType: file.type
    };
    const task = ref.child(file.name).put(file, metadata);
    task
      .then(snapshot => snapshot.ref.getDownloadURL())
      .then(url => {
        document.getElementById("img").innerHTML =
          '<center><div id="img" src="' +
          url +
          '><img id="image" alt="Example"><br><br></div></center>';
        if (button == "send") {
          document.getElementById("imageLink").value = url;
          sendClick();
        } else {
          document.getElementById("imageLink").value = url;
          shareClick();
        }
      });
  }
</script>

</html>
